# This is a basic workflow to help you get started with Actions

name: CI

# Controls when the action will run. 
on:
  workflow_dispatch:
    # Inputs the workflow accepts.
    inputs:
      name:
        # Friendly description to be shown in the UI instead of 'name'
        description: 'Person to greet'
        # Default value if no value is explicitly provided
        default: 'World'
        # Input has to be provided for the workflow to run
        required: true

env:
  HAXELIB_ROOT: /home/appveyor/haxelib
  HAXE_INSTALLDIR: /home/appveyor/haxe
  SRC_REPO: https://github.com/aflacc/ProjectFNF.git

# A workflow run is made up of one or more jobs that can run sequentially or in parallel
jobs:
  install:
    # The type of runner that the job will run on
    runs-on: ubuntu-20.04

    # Steps represent a sequence of tasks that will be executed as part of the job
    steps:
      - run: cd /home
      - run: mkdir home/appveyor
      - run: mkdir home/appveyor/site
      - run: cd /home/appveyor/site
      - run: git checkout main
      - run: cd /home/appveyor
      - run: sudo add-apt-repository ppa:haxe/releases -y
      - run: sudo apt update
      - run: sudo apt install neko tar -y
      - run: wget https://github.com/HaxeFoundation/haxe/releases/download/4.1.5/haxe-4.1.5-linux64.tar.gz
      - run: mkdir $HAXE_INSTALLDIR
      - run: tar -xf haxe-4.1.5-linux64.tar.gz -C $HAXE_INSTALLDIR
      - run: export PATH=$PATH:$HAXE_INSTALLDIR/haxe_20201231082044_5e33a78aa
      - run: mkdir $HAXELIB_ROOT && haxelib setup $HAXELIB_ROOT
      - run: haxelib install lime 7.9.0
      - run: haxelib install openfl
      - run: haxelib install flixel
      - run: haxelib run lime setup flixel
      - run: haxelib run lime setup
      - run: haxelib install flixel-tools
      - run: haxelib install flixel-addons
      - run: haxelib install flixel-ui
      - run: haxelib install hscript
      - run: haxelib install newgrounds
      - run: haxelib git faxe https://github.com/uhrobots/faxe
      - run: haxelib git polymod https://github.com/larsiusprime/polymod.git
      - run: haxelib git discord_rpc https://github.com/Aidan63/linc_discord-rpc
      - run: haxelib list
      - run: git clone $SRC_REPO /home/appveyor/src
